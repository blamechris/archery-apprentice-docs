<!DOCTYPE html>
<html lang="en" dir="ltr"><head><title>kmp-migration-project</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Archery Apprentice Documentation"/><meta property="og:title" content="kmp-migration-project"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="kmp-migration-project"/><meta name="twitter:description" content="KMP Migration Project - Archery Apprentice Status: Week 1 in progress Started: 2025-10-18 Goal: Migrate Android app to Kotlin Multiplatform to enable iOS development Tags: kmp kotlin-multiplatform ios migration architecture Project Overview Mission Migrate the Archery Apprentice Android app to Kotli..."/><meta property="og:description" content="KMP Migration Project - Archery Apprentice Status: Week 1 in progress Started: 2025-10-18 Goal: Migrate Android app to Kotlin Multiplatform to enable iOS development Tags: kmp kotlin-multiplatform ios migration architecture Project Overview Mission Migrate the Archery Apprentice Android app to Kotli..."/><meta property="og:image:alt" content="KMP Migration Project - Archery Apprentice Status: Week 1 in progress Started: 2025-10-18 Goal: Migrate Android app to Kotlin Multiplatform to enable iOS development Tags: kmp kotlin-multiplatform ios migration architecture Project Overview Mission Migrate the Archery Apprentice Android app to Kotli..."/><meta property="twitter:domain" content="blamechris.github.io/archery-apprentice-docs"/><meta property="og:url" content="https://blamechris.github.io/archery-apprentice-docs/internal/kmp-migration/kmp-migration-project"/><meta property="twitter:url" content="https://blamechris.github.io/archery-apprentice-docs/internal/kmp-migration/kmp-migration-project"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="KMP Migration Project - Archery Apprentice Status: Week 1 in progress Started: 2025-10-18 Goal: Migrate Android app to Kotlin Multiplatform to enable iOS development Tags: kmp kotlin-multiplatform ios migration architecture Project Overview Mission Migrate the Archery Apprentice Android app to Kotli..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvYXJjaGVyeS1hcHByZW50aWNlLWRvY3MvYXJjaGVyeS1hcHByZW50aWNlLWRvY3MvcXVhcnR6L2NvbXBvbmVudHMvc3R5bGVzIiwic291cmNlcyI6WyJtZXJtYWlkLmlubGluZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFHRjtFQUNFOzs7QUFLRjtFQUNFO0VBQ0E7OztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFOztBQUlGO0VBQ0U7RUFDQTtFQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLmV4cGFuZC1idXR0b24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsb2F0OiByaWdodDtcbiAgcGFkZGluZzogMC40cmVtO1xuICBtYXJnaW46IDAuM3JlbTtcbiAgcmlnaHQ6IDA7IC8vIE5PVEU6IHJpZ2h0IHdpbGwgYmUgc2V0IGluIG1lcm1haWQuaW5saW5lLnRzXG4gIGNvbG9yOiB2YXIoLS1ncmF5KTtcbiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICBib3JkZXI6IDFweCBzb2xpZDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xuICBvcGFjaXR5OiAwO1xuICB0cmFuc2l0aW9uOiAwLjJzO1xuXG4gICYgPiBzdmcge1xuICAgIGZpbGw6IHZhcigtLWxpZ2h0KTtcbiAgICBmaWx0ZXI6IGNvbnRyYXN0KDAuMyk7XG4gIH1cblxuICAmOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zZWNvbmRhcnkpO1xuICB9XG5cbiAgJjpmb2N1cyB7XG4gICAgb3V0bGluZTogMDtcbiAgfVxufVxuXG5wcmUge1xuICAmOmhvdmVyID4gLmV4cGFuZC1idXR0b24ge1xuICAgIG9wYWNpdHk6IDE7XG4gICAgdHJhbnNpdGlvbjogMC4ycztcbiAgfVxufVxuXG4jbWVybWFpZC1jb250YWluZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGNvbnRhaW46IGxheW91dDtcbiAgei1pbmRleDogOTk5O1xuICBsZWZ0OiAwO1xuICB0b3A6IDA7XG4gIHdpZHRoOiAxMDB2dztcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgZGlzcGxheTogbm9uZTtcbiAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCk7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTtcblxuICAmLmFjdGl2ZSB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB9XG5cbiAgJiA+ICNtZXJtYWlkLXNwYWNlIHtcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogNTAlO1xuICAgIGxlZnQ6IDUwJTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcbiAgICBoZWlnaHQ6IDgwdmg7XG4gICAgd2lkdGg6IDgwdnc7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAgICYgPiAubWVybWFpZC1jb250ZW50IHtcbiAgICAgIHBhZGRpbmc6IDJyZW07XG4gICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xcyBlYXNlO1xuICAgICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gICAgICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgICAgIG1pbi13aWR0aDogMjAwcHg7XG5cbiAgICAgIHByZSB7XG4gICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgfVxuXG4gICAgICBzdmcge1xuICAgICAgICBtYXgtd2lkdGg6IG5vbmU7XG4gICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmID4gLm1lcm1haWQtY29udHJvbHMge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAyMHB4O1xuICAgICAgcmlnaHQ6IDIwcHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZ2FwOiA4cHg7XG4gICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgIHotaW5kZXg6IDI7XG5cbiAgICAgIC5tZXJtYWlkLWNvbnRyb2wtYnV0dG9uIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIHdpZHRoOiAzMnB4O1xuICAgICAgICBoZWlnaHQ6IDMycHg7XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgICAgY29sb3I6IHZhcigtLWRhcmspO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICBmb250LWZhbWlseTogdmFyKC0tYm9keUZvbnQpO1xuICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXG4gICAgICAgICY6aG92ZXIge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIH1cblxuICAgICAgICAmOmFjdGl2ZSB7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDFweCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdHlsZSB0aGUgcmVzZXQgYnV0dG9uIGRpZmZlcmVudGx5XG4gICAgICAgICY6bnRoLWNoaWxkKDIpIHtcbiAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgICBwYWRkaW5nOiAwIDEycHg7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0= */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://blamechris.github.io/archery-apprentice-docs/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://blamechris.github.io/archery-apprentice-docs/internal/kmp-migration/kmp-migration-project-og-image.webp"/><meta property="og:image:url" content="https://blamechris.github.io/archery-apprentice-docs/internal/kmp-migration/kmp-migration-project-og-image.webp"/><meta name="twitter:image" content="https://blamechris.github.io/archery-apprentice-docs/internal/kmp-migration/kmp-migration-project-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="internal/kmp-migration/kmp-migration-project"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">Archery Apprentice Documentation</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>Search</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-370"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-370" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../internal/">internal</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../internal/kmp-migration/">kmp migration</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>kmp migration project</a></div></nav><h1 class="article-title">kmp-migration-project</h1><p show-comma="true" class="content-meta"><time datetime="2025-11-04T05:49:57.000Z">Nov 04, 2025</time><span>9 min read</span></p><ul class="tags"><li><a href="../../tags/kmp" class="internal tag-link">kmp</a></li><li><a href="../../tags/kotlin-multiplatform" class="internal tag-link">kotlin-multiplatform</a></li><li><a href="../../tags/ios" class="internal tag-link">ios</a></li><li><a href="../../tags/migration" class="internal tag-link">migration</a></li><li><a href="../../tags/architecture" class="internal tag-link">architecture</a></li></ul></div></div><article class="popover-hint"><h1 id="kmp-migration-project---archery-apprentice">KMP Migration Project - Archery Apprentice<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#kmp-migration-project---archery-apprentice" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p><strong>Status:</strong> Week 1 in progress<br/>
<strong>Started:</strong> 2025-10-18<br/>
<strong>Goal:</strong> Migrate Android app to Kotlin Multiplatform to enable iOS development<br/>
<strong>Tags:</strong> <a href="../.././../tags/kmp" class="tag-link internal alias" data-slug="tags/kmp">kmp</a> <a href="../.././../tags/kotlin-multiplatform" class="tag-link internal alias" data-slug="tags/kotlin-multiplatform">kotlin-multiplatform</a> <a href="../.././../tags/ios" class="tag-link internal alias" data-slug="tags/ios">ios</a> <a href="../.././../tags/migration" class="tag-link internal alias" data-slug="tags/migration">migration</a> <a href="../.././../tags/architecture" class="tag-link internal alias" data-slug="tags/architecture">architecture</a></p>
<hr/>
<h2 id="project-overview">Project Overview<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#project-overview" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="mission">Mission<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mission" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Migrate the Archery Apprentice Android app to Kotlin Multiplatform (KMP) to enable code sharing between Android and iOS platforms. This is a strategic architectural transformation to expand the app from Android-only to cross-platform.</p>
<h3 id="key-objectives">Key Objectives<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#key-objectives" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Extract platform-agnostic business logic into shared modules</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create platform abstractions for Android-specific dependencies</li>
<li class="task-list-item"><input type="checkbox" disabled/> Refactor god classes to enable better code organization</li>
<li class="task-list-item"><input type="checkbox" disabled/> Maintain 80% test coverage throughout migration</li>
<li class="task-list-item"><input type="checkbox" disabled/> Enable iOS development with shared codebase</li>
</ul>
<hr/>
<h2 id="strategic-approach-parallel-agent-migration">Strategic Approach: Parallel Agent Migration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#strategic-approach-parallel-agent-migration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="why-parallel-agents">Why Parallel Agents?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#why-parallel-agents" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Traditional sequential migration would take weeks of blocking work. By using 3 parallel agents working in Git worktrees, we can:</p>
<ul>
<li>Complete Week 1 in ~3 days instead of 3+ weeks</li>
<li>Maintain app stability (agents work on branches, not main)</li>
<li>Minimize merge conflicts through strategic merge ordering</li>
<li>Enable experimentation without risk to production code</li>
</ul>
<h3 id="three-agent-strategy">Three-Agent Strategy<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#three-agent-strategy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Agent 1 (AAP) - Platform Abstractions</strong></p>
<ul>
<li><strong>Branch:</strong> <code>kmp-migration/platform-abstractions</code></li>
<li><strong>Mission:</strong> Remove Android <code>Context</code> dependencies from domain layer</li>
<li><strong>Deliverables:</strong>
<ul>
<li>Platform abstraction interfaces (PreferenceStorage, NetworkMonitor, TournamentModeProvider)</li>
<li>Android implementations in app module</li>
<li>Clean domain layer (no Android SDK dependencies)</li>
<li>Updated test mocks for platform abstractions</li>
</ul>
</li>
</ul>
<p><strong>Agent 2 (AAM) - Module Setup</strong></p>
<ul>
<li><strong>Branch:</strong> <code>kmp-migration/module-setup</code> (MERGED)</li>
<li><strong>Mission:</strong> Create KMP shared modules structure</li>
<li><strong>Deliverables:</strong>
<ul>
<li>6 shared modules (common, domain, data, database, presentation, di)</li>
<li>Room KMP 2.8.1 configuration</li>
<li>Gradle build scripts for multiplatform</li>
<li>MODULE_ARCHITECTURE.md and DI_STRATEGY.md documentation</li>
</ul>
</li>
</ul>
<p><strong>Agent 3 (AAA) - Code Analysis</strong></p>
<ul>
<li><strong>Branch:</strong> <code>kmp-migration/code-analysis</code> (MERGED)</li>
<li><strong>Mission:</strong> Analyze god classes and create extraction plans</li>
<li><strong>Deliverables:</strong>
<ul>
<li>GOD_CLASS_EXTRACTION_PLANS.md (3 god classes analyzed)</li>
<li>VIEWMODEL_INVENTORY.md (25 ViewModels catalogued)</li>
<li>WEEK_5_8_PLAN.md (service extraction roadmap)</li>
<li>Refactoring priority recommendations</li>
</ul>
</li>
</ul>
<hr/>
<h2 id="week-1-progress">Week 1 Progress<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-1-progress" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="-completed">✅ Completed<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#-completed" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li>
<p><strong>Agent 3 (AAA)</strong> - Code analysis complete, PR merged</p>
<ul>
<li>Identified 3 god classes (LiveScoringViewModel: 2,015 lines, HybridTournamentRepository: 1,808 lines, RoundViewModel: 2,177 lines)</li>
<li>Created extraction roadmaps for Weeks 5-8</li>
<li>Catalogued all 25 ViewModels in the app</li>
</ul>
</li>
<li>
<p><strong>Agent 2 (AAM)</strong> - Module setup complete, PR merged</p>
<ul>
<li>Created shared KMP module structure</li>
<li>Configured Room KMP 2.8.1 with KSP</li>
<li>Documented DI strategy (manual DI via SharedModuleFactory)</li>
<li>Integrated with existing Android app gradle structure</li>
</ul>
</li>
</ol>
<h3 id="-in-progress">⏳ In Progress<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#-in-progress" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol start="3">
<li><strong>Agent 1 (AAP)</strong> - Platform abstractions (raising code coverage)
<ul>
<li>Created 3 platform abstractions</li>
<li>Removed Context from 6 domain layer files</li>
<li>Fixed 96 test occurrences across 15 files</li>
<li>Currently raising test coverage to meet 80% threshold</li>
</ul>
</li>
</ol>
<hr/>
<h2 id="week-3-progress-2025-10-25">Week 3 Progress (2025-10-25)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-3-progress-2025-10-25" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="agent-1-aap---coverage-improvements--complete">Agent 1 (AAP) - Coverage Improvements ✅ COMPLETE<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#agent-1-aap---coverage-improvements--complete" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Status:</strong> PR #139 created, 80% goal exceeded (81% achieved)</p>
<p><strong>Accomplishments:</strong></p>
<ul>
<li>Overall coverage: 77% → 81% (+4 points)</li>
<li>Repository layer: 59% → 70% (+11 points)</li>
<li>50 strategic tests added</li>
<li><strong>Critical fix:</strong> JaCoCo configuration bug (.exec file was 0 bytes)</li>
</ul>
<p><strong>Impact:</strong></p>
<ul>
<li>All future coverage measurements now accurate</li>
<li>Repository layer significantly improved</li>
<li>Infrastructure improvement benefits entire project</li>
</ul>
<p><strong>Files:</strong></p>
<ul>
<li><a href="https://github.com/blamechris/archery-apprentice/pull/139" class="external">PR #139<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://github.com/blamechris/archery-apprentice/blob/main/docs/AGENT_CONTEXTS/AGENT_1_AAP.md" class="external">Agent 1 Context<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="agent-2-aam---data-migration--complete">Agent 2 (AAM) - Data Migration ✅ COMPLETE<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#agent-2-aam---data-migration--complete" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Status:</strong> PR #140 created, coverage improvements in progress</p>
<p><strong>Accomplished:</strong></p>
<ul>
<li>768 lines migrated to shared:data (100% KMP compatible)</li>
<li>OfflineTournamentRepository fully restored from pre-stub version</li>
<li>All 30 test failures resolved (27 OfflineTournamentRepositoryTest + 3 HybridTournamentRepositoryTest)</li>
<li>All 3,860+ tests passing (100% pass rate maintained)</li>
<li>KMP compatibility: 100% (zero Android dependencies)</li>
</ul>
<p><strong>Data Models Migrated:</strong></p>
<ul>
<li>Days 1-3: TournamentRound, TournamentScore, EndScoreWithArrows + statistics (317 lines)</li>
<li>Day 4: TournamentSettings (269 lines, most complex - Date → kotlinx-datetime conversion)</li>
<li>Day 5: Security models (182 lines)</li>
<li>Days 6-7: OfflineTournamentRepository restoration (40+ shared:domain imports + 10+ shared:data imports)</li>
<li>Day 8: Copilot review fix (validateJoinCode) + branch conflict resolution + documentation</li>
</ul>
<p><strong>Files:</strong></p>
<ul>
<li><a href="https://github.com/blamechris/archery-apprentice/pull/140" class="external">PR #140<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://github.com/blamechris/archery-apprentice/blob/main/docs/AGENT_CONTEXTS/AGENT_2_AAM.md" class="external">Agent 2 Context<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="agent-3-aaa---service-extraction--complete---exceeded-goal">Agent 3 (AAA) - Service Extraction ✅ COMPLETE - EXCEEDED GOAL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#agent-3-aaa---service-extraction--complete---exceeded-goal" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Status:</strong> PR pushed to <code>kmp-migration/week-3-service-extraction-continued</code>, ready for merge</p>
<p><strong>Accomplishments:</strong></p>
<ul>
<li>LiveScoringViewModel: 1,691 → 1,481 lines (210 line reduction, 12.4%)</li>
<li><strong>EXCEEDED &lt;1,500 line goal by 19 lines!</strong></li>
<li>Services: EndStateTransitionService (230 lines) + ProgressUpdateService (85 lines)</li>
<li>37 tests added (21 service + 13 service + 3 error case tests)</li>
<li>1 critical bug fixed (negative index in updateArrowScore)</li>
<li>Zero failures, zero regressions</li>
<li>Coverage improvements: Removed 4 debug/error logs, simplified null checks</li>
</ul>
<p><strong>Technical Debt Discovered:</strong></p>
<ul>
<li><strong>Issue #5:</strong> EndStateTransitionService uses <code>androidx.compose.ui.geometry.Offset</code> (Android-only)
<ul>
<li>Impact: Prevents full KMP compatibility for this service</li>
<li>Solution: Create DomainCoordinate model in shared:domain (Week 4 priority)</li>
<li>Tracking: <a href="https://github.com/blamechris/archery-apprentice/blob/main/docs/TECH_DEBT.md#5-endstatetransitionservice-compose-ui-dependency" class="external">Tech Debt #5<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
</li>
</ul>
<p><strong>Cumulative (Week 2+3):</strong></p>
<ul>
<li>Starting Point: 2,015 lines</li>
<li>Week 2 End: 1,677 lines (338 line reduction)</li>
<li>Week 3 End: 1,481 lines (210 line reduction)</li>
<li><strong>Total reduction: 534 lines (26.5%)</strong></li>
<li><strong>Services extracted: 6 services (Weeks 2-3)</strong></li>
<li><strong>Tests added: 120 tests (83 Week 2 + 37 Week 3)</strong></li>
</ul>
<p><strong>Documentation:</strong></p>
<ul>
<li><a href="https://github.com/blamechris/archery-apprentice/blob/main/docs/kmp-migration/WEEK_3_COMPLETION_SUMMARY.md" class="external">Week 3 Completion Summary<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://github.com/blamechris/archery-apprentice/blob/main/docs/AGENT_CONTEXTS/AGENT_3_AAA.md" class="external">Agent 3 Context<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<hr/>
<h2 id="critical-technical-decisions">Critical Technical Decisions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#critical-technical-decisions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="1-git-worktrees-over-docker">1. Git Worktrees Over Docker<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-git-worktrees-over-docker" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Decision:</strong> Use Git worktrees for parallel agent work<br/>
<strong>Rationale:</strong></p>
<ul>
<li>Setup time: 30 seconds vs 2 hours for Docker</li>
<li>No learning curve vs 3-4 hours for Docker</li>
<li>Native performance (no overhead)</li>
<li>Perfect for our use case (same machine, different branches)</li>
</ul>
<p><strong>Impact:</strong> All 3 agents working efficiently in parallel without conflicts</p>
<h3 id="2-manual-di-over-hiltkoin">2. Manual DI Over Hilt/Koin<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-manual-di-over-hiltkoin" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Decision:</strong> Extend existing RepositoryFactory pattern to SharedModuleFactory<br/>
<strong>Rationale:</strong></p>
<ul>
<li>Project already uses manual DI successfully</li>
<li>No learning curve for existing patterns</li>
<li>Easier incremental migration</li>
<li>KMP DI libraries less mature than Android equivalents</li>
</ul>
<p><strong>Impact:</strong> Consistent DI approach across Android and shared code</p>
<h3 id="3-merge-order-agent-3--agent-2--agent-1">3. Merge Order: Agent 3 → Agent 2 → Agent 1<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-merge-order-agent-3--agent-2--agent-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Decision:</strong> Strategic merge ordering based on risk<br/>
<strong>Rationale:</strong></p>
<ol>
<li>Agent 3: Documentation only (safest, no code conflicts)</li>
<li>Agent 2: New modules (additive, no existing code changes)</li>
<li>Agent 1: Modifies existing code (needs clean base from Agent 2’s modules)</li>
</ol>
<p><strong>Impact:</strong> Minimized merge conflicts, enabled continuous parallel work</p>
<hr/>
<h2 id="technical-challenges-resolved">Technical Challenges Resolved<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#technical-challenges-resolved" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="challenge-1-kotlin-version-conflict">Challenge 1: Kotlin Version Conflict<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#challenge-1-kotlin-version-conflict" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem:</strong> Room KMP 2.8.1 pulled Kotlin 2.1.20-dev, project uses 2.0.21<br/>
<strong>Error:</strong> <code>Incompatible ABI version. Current: '1.8.0', found: '1.201.0'</code><br/>
<strong>Solution:</strong> Force resolution in shared/di/build.gradle.kts</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="kotlin" data-theme="github-light github-dark"><code data-language="kotlin" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">configurations.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    resolutionStrategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        force</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;org.jetbrains.kotlin:kotlin-stdlib:2.0.21&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        force</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;org.jetbrains.kotlin:kotlin-stdlib-common:2.0.21&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<h3 id="challenge-2-test-failures-from-platform-abstractions">Challenge 2: Test Failures from Platform Abstractions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#challenge-2-test-failures-from-platform-abstractions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem:</strong> 21+ test failures after removing Context parameters<br/>
<strong>Root Cause:</strong> <code>RepositoryFactory.createTournamentRepository()</code> checks <code>PlatformProvider.isInitialized()</code>, falls back to <code>OfflineTournamentRepository</code> when false<br/>
<strong>Solution:</strong> Created MockPlatformProviders.kt, mocked PlatformProvider in all affected tests<br/>
<strong>Smart Fix:</strong> Fixed <code>RoundViewModelTestBase.kt</code> which cascaded to 19 child test files</p>
<h3 id="challenge-3-worktree-isolation">Challenge 3: Worktree Isolation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#challenge-3-worktree-isolation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem:</strong> Agents can’t see each other’s files (expected worktree behavior)<br/>
<strong>Solution:</strong> Strategic merge order - Agent 3 merges first, others pull main to get docs<br/>
<strong>Lesson:</strong> Coordination requires explicit merge strategy</p>
<hr/>
<h2 id="architecture-foundation">Architecture Foundation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#architecture-foundation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="current-android-app">Current Android App<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#current-android-app" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Type:</strong> Single-module Android app</li>
<li><strong>Build System:</strong> Gradle with version catalog (libs.versions.toml)</li>
<li><strong>DI:</strong> Manual (RepositoryFactory pattern)</li>
<li><strong>Database:</strong> Room (migrating to Room KMP)</li>
<li><strong>UI:</strong> Jetpack Compose</li>
<li><strong>Target SDK:</strong> compileSdk=36, minSdk=31</li>
<li><strong>JVM:</strong> Java 11</li>
<li><strong>Kotlin:</strong> 2.0.21</li>
</ul>
<h3 id="target-kmp-architecture">Target KMP Architecture<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#target-kmp-architecture" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>shared/
├── common/          # Common utilities, expect/actual
├── domain/          # Business logic (platform-agnostic)
├── data/            # Repository implementations
├── database/        # Room KMP database
├── presentation/    # ViewModels, UI state
└── di/              # Dependency injection
</code></pre>
<h3 id="platform-abstractions-created">Platform Abstractions Created<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#platform-abstractions-created" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>PreferenceStorage</strong> - SharedPreferences wrapper (was using Context.getSharedPreferences)</li>
<li><strong>NetworkMonitor</strong> - ConnectivityManager wrapper (was using Context.getSystemService)</li>
<li><strong>TournamentModeProvider</strong> - Build config access (was using Context for debug/release detection)</li>
</ol>
<hr/>
<h2 id="test-coverage-strategy">Test Coverage Strategy<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#test-coverage-strategy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="coverage-requirements">Coverage Requirements<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#coverage-requirements" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Threshold:</strong> 80% (enforced in CI/CD)</li>
<li><strong>Current Tests:</strong> 238 unit tests + 51 instrumented tests</li>
<li><strong>Strategy:</strong> Maintain coverage throughout migration</li>
</ul>
<h3 id="testing-approach-for-migration">Testing Approach for Migration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#testing-approach-for-migration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>Each agent must maintain/raise test coverage</li>
<li>Platform abstractions require comprehensive test mocking</li>
<li>Shared module tests must be platform-agnostic</li>
<li>Use MockPlatformProviders.kt for platform dependency mocking</li>
</ul>
<hr/>
<h2 id="week-2-planning-pending-week-1-completion">Week 2 Planning (Pending Week 1 Completion)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-2-planning-pending-week-1-completion" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="prerequisites">Prerequisites<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#prerequisites" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Agent 1 CI/CD passes</li>
<li class="task-list-item"><input type="checkbox" disabled/> Agent 1 PR merged to main</li>
<li class="task-list-item"><input type="checkbox" disabled/> All agents pull latest main</li>
<li class="task-list-item"><input type="checkbox" disabled/> Week 1 retrospective completed</li>
</ul>
<h3 id="week-2-focus-areas">Week 2 Focus Areas<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-2-focus-areas" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Code Migration</strong> - Move domain logic into shared modules</li>
<li><strong>Refactoring</strong> - Begin god class extraction based on Agent 3’s plans</li>
<li><strong>Testing</strong> - Ensure shared code has comprehensive test coverage</li>
<li><strong>Integration</strong> - Verify Android app works with shared modules</li>
</ol>
<hr/>
<h2 id="success-metrics">Success Metrics<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#success-metrics" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="week-1-foundation">Week 1 (Foundation)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-1-foundation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>✅ Platform abstractions created</li>
<li>✅ KMP module structure established</li>
<li>✅ God class extraction plans documented</li>
<li>⏳ All changes merged to main with passing CI/CD</li>
</ul>
<h3 id="week-2-4-migration">Week 2-4 (Migration)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-2-4-migration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>Domain layer code moved to shared modules</li>
<li>Platform-specific implementations in app module</li>
<li>Test coverage maintained at 80%+</li>
</ul>
<h3 id="week-5-8-refactoring">Week 5-8 (Refactoring)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-5-8-refactoring" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>God classes extracted into services</li>
<li>Improved architecture and maintainability</li>
<li>Ready for iOS development</li>
</ul>
<h3 id="week-9-ios-development">Week 9+ (iOS Development)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-9-ios-development" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>iOS app created</li>
<li>Shared modules integrated</li>
<li>Cross-platform feature parity</li>
</ul>
<hr/>
<h2 id="resources">Resources<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#resources" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="documentation">Documentation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#documentation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><code>docs/AGENT_CONTEXTS/AGENT_O_ORCHESTRATOR.md</code> - Coordination context</li>
<li><code>docs/MODULE_ARCHITECTURE.md</code> - KMP module structure (Agent 2)</li>
<li><code>docs/DI_STRATEGY.md</code> - Dependency injection approach (Agent 2)</li>
<li><code>docs/GOD_CLASS_EXTRACTION_PLANS.md</code> - Refactoring roadmap (Agent 3)</li>
<li><code>docs/VIEWMODEL_INVENTORY.md</code> - Complete ViewModel catalogue (Agent 3)</li>
</ul>
<h3 id="git-setup">Git Setup<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#git-setup" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># List current worktrees</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> worktree</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Agent worktrees (Week 1)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">archery-apprentice/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Main repo</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">archery-agent-platform/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Agent 1 (AAP)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">archery-agent-modules/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       # Agent 2 (AAM) - MERGED</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">archery-agent-analysis/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Agent 3 (AAA) - MERGED</span></span></code></pre></figure>
<hr/>
<h2 id="next-steps">Next Steps<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#next-steps" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li><strong>Immediate:</strong> Wait for Agent 1 code coverage work to complete</li>
<li><strong>Short-term:</strong> Merge Agent 1 PR after CI/CD passes</li>
<li><strong>Week 1 Closeout:</strong> Retrospective on parallel agent workflow</li>
<li><strong>Week 2 Kickoff:</strong> Define next missions for all 3 agents</li>
</ol>
<h2 id="week-5-8-update-multi-agent-progress">Week 5-8 Update: Multi-Agent Progress<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#week-5-8-update-multi-agent-progress" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>Date:</strong> 2025-10-26
<strong>Orchestrator:</strong> Agent O</p>
<h3 id="overall-progress">Overall Progress<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#overall-progress" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Weeks Completed:</strong> 5-8 (16 days)</li>
<li><strong>PRs Merged:</strong> 7 (#144, #149, #150, #151, #152, #153, #154 pending)</li>
<li><strong>Agent Task Completion:</strong> 100% (all weekly goals met)</li>
<li><strong>Test Coverage:</strong> 81% → 84-85% (+3-4% absolute)</li>
<li><strong>Blockers:</strong> 0 unresolved</li>
</ul>
<h3 id="agent-work-summary">Agent Work Summary<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#agent-work-summary" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Agent 1 (AAP) - Platform Abstractions:</strong></p>
<ul>
<li>Week 7: Pattern 3 Phase 1 (3 abstractions implemented, PR #152 merged)</li>
<li>Week 8: Pattern 3 Phase 2 (ExportUtils migration, PR #154 in progress)</li>
<li>Next: Week 9 Context-dependent service migrations</li>
</ul>
<p><strong>Agent 2 (AAM) - Database Migration:</strong></p>
<ul>
<li>Week 6: Database planning (22 entities analyzed, PR #150 merged)</li>
<li>Week 7: Pattern 3 review (Agent 1’s PR #152 APPROVED)</li>
<li>Next: Week 9 entity migration (kotlinx.serialization + 5 entities)</li>
</ul>
<p><strong>Agent 3 (AAA) - Test Coverage:</strong></p>
<ul>
<li>Week 7: P0 test coverage (20 tests, PR #151 merged)</li>
<li>Week 8: P1 test coverage (25 tests, PR #153 merged)</li>
<li>Next: Week 9 validation support (fix ~40 tests, maintain 82%+ coverage)</li>
</ul>
<h3 id="key-achievements">Key Achievements<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#key-achievements" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>✅ Pattern 3 validated (3 abstractions working)</li>
<li>✅ Database migration ready (“paint by numbers” plan)</li>
<li>✅ Test coverage baseline improved (ready for Week 9)</li>
<li>✅ Cross-agent collaboration successful (reviews, approvals)</li>
</ul>
<h3 id="next-milestone-week-9">Next Milestone (Week 9)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#next-milestone-week-9" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Primary:</strong> Agent 2 entity migration (5 entities to shared:database)</li>
<li><strong>Secondary:</strong> Agent 1 service migrations (3-5 services using Pattern 3)</li>
<li><strong>Support:</strong> Agent 3 validation (maintain 82%+ coverage)</li>
</ul>
<p>See: <code>projects/kmp-migration/Week 5-8 Overall Status.md</code> for full details.</p>
<hr/>
<p><strong>Last Updated:</strong> 2025-10-26
<strong>Next Review:</strong> Week 9 kickoff (Monday 2025-10-28)</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-137" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#kmp-migration-project---archery-apprentice" data-for="kmp-migration-project---archery-apprentice">KMP Migration Project - Archery Apprentice</a></li><li class="depth-1"><a href="#project-overview" data-for="project-overview">Project Overview</a></li><li class="depth-2"><a href="#mission" data-for="mission">Mission</a></li><li class="depth-2"><a href="#key-objectives" data-for="key-objectives">Key Objectives</a></li><li class="depth-1"><a href="#strategic-approach-parallel-agent-migration" data-for="strategic-approach-parallel-agent-migration">Strategic Approach: Parallel Agent Migration</a></li><li class="depth-2"><a href="#why-parallel-agents" data-for="why-parallel-agents">Why Parallel Agents?</a></li><li class="depth-2"><a href="#three-agent-strategy" data-for="three-agent-strategy">Three-Agent Strategy</a></li><li class="depth-1"><a href="#week-1-progress" data-for="week-1-progress">Week 1 Progress</a></li><li class="depth-2"><a href="#-completed" data-for="-completed">✅ Completed</a></li><li class="depth-2"><a href="#-in-progress" data-for="-in-progress">⏳ In Progress</a></li><li class="depth-1"><a href="#week-3-progress-2025-10-25" data-for="week-3-progress-2025-10-25">Week 3 Progress (2025-10-25)</a></li><li class="depth-2"><a href="#agent-1-aap---coverage-improvements--complete" data-for="agent-1-aap---coverage-improvements--complete">Agent 1 (AAP) - Coverage Improvements ✅ COMPLETE</a></li><li class="depth-2"><a href="#agent-2-aam---data-migration--complete" data-for="agent-2-aam---data-migration--complete">Agent 2 (AAM) - Data Migration ✅ COMPLETE</a></li><li class="depth-2"><a href="#agent-3-aaa---service-extraction--complete---exceeded-goal" data-for="agent-3-aaa---service-extraction--complete---exceeded-goal">Agent 3 (AAA) - Service Extraction ✅ COMPLETE - EXCEEDED GOAL</a></li><li class="depth-1"><a href="#critical-technical-decisions" data-for="critical-technical-decisions">Critical Technical Decisions</a></li><li class="depth-2"><a href="#1-git-worktrees-over-docker" data-for="1-git-worktrees-over-docker">1. Git Worktrees Over Docker</a></li><li class="depth-2"><a href="#2-manual-di-over-hiltkoin" data-for="2-manual-di-over-hiltkoin">2. Manual DI Over Hilt/Koin</a></li><li class="depth-2"><a href="#3-merge-order-agent-3--agent-2--agent-1" data-for="3-merge-order-agent-3--agent-2--agent-1">3. Merge Order: Agent 3 → Agent 2 → Agent 1</a></li><li class="depth-1"><a href="#technical-challenges-resolved" data-for="technical-challenges-resolved">Technical Challenges Resolved</a></li><li class="depth-2"><a href="#challenge-1-kotlin-version-conflict" data-for="challenge-1-kotlin-version-conflict">Challenge 1: Kotlin Version Conflict</a></li><li class="depth-2"><a href="#challenge-2-test-failures-from-platform-abstractions" data-for="challenge-2-test-failures-from-platform-abstractions">Challenge 2: Test Failures from Platform Abstractions</a></li><li class="depth-2"><a href="#challenge-3-worktree-isolation" data-for="challenge-3-worktree-isolation">Challenge 3: Worktree Isolation</a></li><li class="depth-1"><a href="#architecture-foundation" data-for="architecture-foundation">Architecture Foundation</a></li><li class="depth-2"><a href="#current-android-app" data-for="current-android-app">Current Android App</a></li><li class="depth-2"><a href="#target-kmp-architecture" data-for="target-kmp-architecture">Target KMP Architecture</a></li><li class="depth-2"><a href="#platform-abstractions-created" data-for="platform-abstractions-created">Platform Abstractions Created</a></li><li class="depth-1"><a href="#test-coverage-strategy" data-for="test-coverage-strategy">Test Coverage Strategy</a></li><li class="depth-2"><a href="#coverage-requirements" data-for="coverage-requirements">Coverage Requirements</a></li><li class="depth-2"><a href="#testing-approach-for-migration" data-for="testing-approach-for-migration">Testing Approach for Migration</a></li><li class="depth-1"><a href="#week-2-planning-pending-week-1-completion" data-for="week-2-planning-pending-week-1-completion">Week 2 Planning (Pending Week 1 Completion)</a></li><li class="depth-2"><a href="#prerequisites" data-for="prerequisites">Prerequisites</a></li><li class="depth-2"><a href="#week-2-focus-areas" data-for="week-2-focus-areas">Week 2 Focus Areas</a></li><li class="depth-1"><a href="#success-metrics" data-for="success-metrics">Success Metrics</a></li><li class="depth-2"><a href="#week-1-foundation" data-for="week-1-foundation">Week 1 (Foundation)</a></li><li class="depth-2"><a href="#week-2-4-migration" data-for="week-2-4-migration">Week 2-4 (Migration)</a></li><li class="depth-2"><a href="#week-5-8-refactoring" data-for="week-5-8-refactoring">Week 5-8 (Refactoring)</a></li><li class="depth-2"><a href="#week-9-ios-development" data-for="week-9-ios-development">Week 9+ (iOS Development)</a></li><li class="depth-1"><a href="#resources" data-for="resources">Resources</a></li><li class="depth-2"><a href="#documentation" data-for="documentation">Documentation</a></li><li class="depth-2"><a href="#git-setup" data-for="git-setup">Git Setup</a></li><li class="depth-1"><a href="#next-steps" data-for="next-steps">Next Steps</a></li><li class="depth-1"><a href="#week-5-8-update-multi-agent-progress" data-for="week-5-8-update-multi-agent-progress">Week 5-8 Update: Multi-Agent Progress</a></li><li class="depth-2"><a href="#overall-progress" data-for="overall-progress">Overall Progress</a></li><li class="depth-2"><a href="#agent-work-summary" data-for="agent-work-summary">Agent Work Summary</a></li><li class="depth-2"><a href="#key-achievements" data-for="key-achievements">Key Achievements</a></li><li class="depth-2"><a href="#next-milestone-week-9" data-for="next-milestone-week-9">Next Milestone (Week 9)</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../postscript.js" type="module"></script></html>